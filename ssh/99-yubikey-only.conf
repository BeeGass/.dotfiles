# YubiKey-only SSH authentication
# Place this file in /etc/ssh/sshd_config.d/

# Use non-standard port
Port 40822

# Disable all password-based authentication
PasswordAuthentication no
PermitEmptyPasswords no
ChallengeResponseAuthentication no
KbdInteractiveAuthentication no

# Ensure public key authentication is enabled
PubkeyAuthentication yes

# Disable root login
PermitRootLogin no

# Only allow specific users (change if needed)
AllowUsers beegass ubuntu

# Increase security
MaxAuthTries 3
MaxSessions 10
MaxStartups 3:50:10
LoginGraceTime 30
LogLevel VERBOSE

# Disable unnecessary features (but keep agent forwarding for GPG)
X11Forwarding no
AllowTcpForwarding no
AllowAgentForwarding yes
PermitTunnel no
StreamLocalBindUnlink yes
