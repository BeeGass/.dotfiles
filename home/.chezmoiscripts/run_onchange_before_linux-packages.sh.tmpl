{{ if and (eq .chezmoi.os "linux") (not .isHpc) (not .isTermux) -}}
#!/bin/bash
set -euo pipefail
source "$HOME/.dotfiles/scripts/lib-common.sh"

# APT packages hash: {{ include ".chezmoidata.yaml" | sha256sum }}

section "Update APT"
sudo apt update
sudo apt install -y --no-install-recommends software-properties-common ca-certificates gnupg

section "Install APT packages"
sudo apt install -y \
{{ range .packages.linux.apt -}}
  {{ . }} \
{{ end }}
  || true

ok "APT packages installed"

section "Create Debian command aliases"
if command -v fdfind >/dev/null 2>&1 && ! command -v fd >/dev/null 2>&1; then
    step "Linking fdfind -> fd"
    sudo ln -sf "$(command -v fdfind)" /usr/local/bin/fd
fi
if command -v batcat >/dev/null 2>&1 && ! command -v bat >/dev/null 2>&1; then
    step "Linking batcat -> bat"
    sudo ln -sf "$(command -v batcat)" /usr/local/bin/bat
fi
ok "Debian aliases configured"
{{ end -}}
